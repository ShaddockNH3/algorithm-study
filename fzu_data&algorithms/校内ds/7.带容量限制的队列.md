[DS X 班级实验作业](http://ds.fzu.edu.cn/std/exp/bf5279a1-1205-4fac-86cd-dc2b5a821f48/d8859b3a-9a80-4954-80c8-ec462539c493/4b855142-8714-4346-a7e1-4ba661d82d07)

# 优质的随从慕名而来

## 题目描述

> YH学长想在酒馆战旗中赢得第一名，因此他要找Bob用漏斗蛋糕招揽一些优质的随从！
> 
> 有n个随从慕名而来，第i个随从的种类是ai。YH学长十分贪心，他每个随从都想要，因此他准备了充足的黄金铸币并**依次**买下每一个随从。但即使如此，他也只能携带m个随从，当新买的随从无法加入队伍时，YH学长只好卖掉队伍里之前最早买下的随从。

> “啊哈，三连！”，机智的YH学长发现利用酒馆中的三连机制能够让随从们变得更加强大。当YH学长买下一个种类为x的随从时，若队伍里有另外两个随从种类也为x，他就凑成了一个“三连”。此时“三连”会将队伍中两个种类为x的随从移除，然后使买下的那个随从变为“金色”并加入队伍。

> 但为了防止YH学长的队伍变得太强，每当YH学长获得“金色”随从时，JC学长就会偷偷卖掉这个”金色“随从。JC学长想知道最后他需要卖掉多少YH学长的”金色“随从。

## 数据输入

第一行包含两个正整数 n，m（1<=m<=n<=1e6），表示随从的个数和队伍的容量。

第二行包含n个整数 ai（1<=ai<=1e6），表示第i次买下的随从的种类。

## 数据输出

输出一个整数，表示JC学长卖出的“金色”随从的个数

|输入示例|
|---|
|10 3|

2 1 1 1 2 3 3 1 3 1|

|输出示例|
|---|
|2|

```
#define LL long long
#define EPS 1e-8
#define INF 0x7fffffff
#define lyh(i,a,b) for(int i=a;i<=b;i++)
#define hyl(i,a,b) for(int i=a;i>=b;i--)
#define debug(a) cout<<#a<<"="<<a<<endl;

#include<bits/stdc++.h>
#include<unordered_map>

using namespace std;

void sale(queue<int> &q, int num) {
	queue<int> temp;
	while (!q.empty()) {
		if (q.front() != num) {
			temp.push(q.front());
		}
		q.pop();
	}
	swap(q, temp);
}

void solve() {
	int n, m; cin >> n >> m;
	queue<int> q;
	unordered_map<int, int> umap;

	int current_num;

	int sum = 0;

	lyh(i, 1, n) {
		cin >> current_num;

		umap[current_num] += 1;

		if (umap[current_num] == 3) {
			sale(q, current_num);
			umap[current_num] = 0;
			sum += 1;
		}

		else {
			if (q.size() == m) {
				umap[q.front()] -= 1;
				q.pop();
			}
			q.push(current_num);
		}
	}

	cout << sum << endl;
}

int main() {
	solve();
	return 0;
}
```


这题我用了一个比较复杂的解法，并且这里需要注意的是，两点，我有两点修bug修了很久

其一是我的逻辑错了，当为3的时候，我完全忽略了应该在非特殊情况插入，以及我也忽略了应该在等于3，移除队列的时候进行umap--的操作。

还有一点就是在进行队列操作时，如果不引用的话，那么相当于没有操作。

### 更优化的解法

再引入一个散列表，来记录谁是无用的元素，无用的元素划掉即可。

